const a="/api";async function b(e,t,n){const o=await fetch(`${a}/brief/parse`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({brief_text:e,conversation_id:t,user_id:n||"anonymous"})});if(!o.ok)throw new Error(`Failed to parse brief: ${o.statusText}`);return o.json()}async function g(e,t,n){const o=await fetch(`${a}/brief/confirm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({brief:e,conversation_id:t,user_id:n||"anonymous"})});if(!o.ok)throw new Error(`Failed to confirm brief: ${o.statusText}`);return o.json()}async function*S(e,t,n){var f;const o=await fetch(`${a}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,conversation_id:t,user_id:n||"anonymous"})});if(!o.ok)throw new Error(`Chat request failed: ${o.statusText}`);const d=(f=o.body)==null?void 0:f.getReader();if(!d)throw new Error("No response body");const s=new TextDecoder;let r="";for(;;){const{done:c,value:u}=await d.read();if(c)break;r+=s.decode(u,{stream:!0});const y=r.split(`

`);r=y.pop()||"";for(const h of y)if(h.startsWith("data: ")){const i=h.slice(6);if(i==="[DONE]")return;try{yield JSON.parse(i)}catch{console.error("Failed to parse SSE data:",i)}}}}async function*T(e,t,n=!0,o,d){var u;const s=await fetch(`${a}/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({brief:e,products:t||[],generate_images:n,conversation_id:o,user_id:d||"anonymous"})});if(!s.ok)throw new Error(`Content generation failed: ${s.statusText}`);const r=(u=s.body)==null?void 0:u.getReader();if(!r)throw new Error("No response body");const f=new TextDecoder;let c="";for(;;){const{done:y,value:h}=await r.read();if(y)break;c+=f.decode(h,{stream:!0});const i=c.split(`

`);c=i.pop()||"";for(const w of i)if(w.startsWith("data: ")){const l=w.slice(6);if(l==="[DONE]")return;try{yield JSON.parse(l)}catch{console.error("Failed to parse SSE data:",l)}}}}async function p(e){const t=new URLSearchParams;e!=null&&e.category&&t.set("category",e.category),e!=null&&e.sub_category&&t.set("sub_category",e.sub_category),e!=null&&e.search&&t.set("search",e.search),e!=null&&e.limit&&t.set("limit",e.limit.toString());const n=await fetch(`${a}/products?${t}`);if(!n.ok)throw new Error(`Failed to get products: ${n.statusText}`);return n.json()}export{g as confirmBrief,p as getProducts,b as parseBrief,S as streamChat,T as streamGenerateContent};
